

Here is an example PowerShell script that will output the users in a specific OU that have logged in in the last 60 days, were created before 7/13/2019, and save it to an Excel file on your desktop:



# Set the path for the output Excel file
$outputFilePath = "$env:userprofile\Desktop\UserLoginReport.xlsx"

# Set the distinguished name of the OU to search for users
$searchBase = "OU=Users-HO,OU=Aspen,DC=aspen,DC=com"

# Set the creation date cutoff
$creationDateCutoff = Get-Date "7/13/2019"

# Get the current date and subtract 60 days
$startDate = (Get-Date).AddDays(-60)

# Get all the user accounts in the specified OU that have logged in since the start date and were created before the cutoff date
$users = Get-ADUser -SearchBase $searchBase -Filter {(LastLogonDate -ge $startDate) -and (whenCreated -lt $creationDateCutoff)} -Properties LastLogonDate, DisplayName, EmailAddress, whenCreated

# Export the user information to an Excel file
$users | Select-Object DisplayName, EmailAddress, LastLogonDate, whenCreated | Export-Excel -Path $outputFilePath -AutoSize  -AutoFilter


In this example, we're using the Get-ADUser cmdlet to retrieve information about user accounts in the specified OU. We're using the -Filter parameter to filter the results to only include accounts that have logged in since the start date and were created before the cutoff date. We're also requesting the LastLogonDate, DisplayName, EmailAddress, and whenCreated properties for each account using the -Properties parameter.

Finally, we're piping the resulting objects to the Export-Excel cmdlet and specifying the output path of the Excel file. The -AutoSize and -AutoFilter options are used to automatically adjust the column widths and add filter options to the Excel file.

