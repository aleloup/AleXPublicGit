You'll need to run this script on a computer that has the Active Directory module for PowerShell installed, 
and you'll need to have the appropriate permissions to modify user objects in Active Directory.

Also, keep in mind that hiding a user from the GAL will prevent that user from being visible to others 
in the organization, so make sure you have a good reason for doing so.


# Replace "username" with the actual username of the user you want to hide
$username = "it_support"

# Get the user object from Active Directory
$user = Get-ADUser $username

# Set the "msExchHideFromAddressLists" attribute to "True"
$user | Set-ADObject -Replace @{msExchHideFromAddressLists=$true}

# Verify that the user is hidden from the GAL
Get-ADUser $username -Properties msExchHideFromAddressLists | Select-Object Name, msExchHideFromAddressLists
