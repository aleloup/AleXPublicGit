


# Define the path of the new folder
$folderPath = "C:\LOCAL"

# Create the new folder if it doesn't already exist
if (-not (Test-Path $folderPath)) {
    New-Item -ItemType Directory -Path $folderPath
}

# Define the path of the file you want to copy
$sourceFile = "\\aspen.com\SYSVOL\aspen.com\aspen-logo.jpg"

# Define the path where you want to copy the file to
$destinationFile = "$folderPath\aspen-logo.jpg"

# Copy the file to the new folder
Copy-Item $sourceFile $destinationFile



$wallpaperPath = "C:\LOCAL\aspen-logo.jpg"
$RegKeyPath = "HKCU:\Control Panel\Desktop"
$RegValueName = "Wallpaper"

# Set the wallpaper
Set-ItemProperty -Path $RegKeyPath -Name $RegValueName -Value $wallpaperPath

# Refresh the desktop to show the new wallpaper
$signature = @"
[DllImport("user32.dll", SetLastError = true)]
public static extern IntPtr SendMessageTimeout(
    IntPtr hWnd,
    uint Msg,
    UIntPtr wParam,
    string lParam,
    uint fuFlags,
    uint uTimeout,
    out UIntPtr lpdwResult);
"@
$User32 = Add-Type -MemberDefinition $signature -Name User32 -Namespace Win32Functions -PassThru
$HWND_BROADCAST = [IntPtr]0xffff
$WM_SETTINGCHANGE = 0x1a
$SPIF_SENDWININICHANGE = 0x02
$null = $User32::SendMessageTimeout($HWND_BROADCAST, $WM_SETTINGCHANGE, [UIntPtr]::Zero, "Environment", $SPIF_SENDWININICHANGE, 5000, [ref][uintptr]::Zero)
